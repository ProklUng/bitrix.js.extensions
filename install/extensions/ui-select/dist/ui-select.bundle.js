this.BX=this.BX||{},function(e,t){"use strict";function r(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,l=function(){};return{s:l,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a=function(){function e(t){babelHelpers.classCallCheck(this,e),this.selector=t}return babelHelpers.createClass(e,[{key:"activate",value:function(){$("select[data-bitrix2-select_id]").each((function(e,t){if($(t).data("bitrix2-select_id")&&!$(t).attr("data-bitrix2-select-activated")){var r=new BX.Protocol.UiSelect($(t).data("bitrix2-select_id"));$(t).attr("data-bitrix2-select-activated",1),r.createTagSelector({placeholder:$(t).data("placeholder")})}}))}},{key:"createTagSelector",value:function(e){var t,n=this.selector,a=[{id:"base",title:"Элементы",itemOrder:{title:"asc"}}];if("object"==babelHelpers.typeof(e)&&e.tabs&&(a=e.tabs),"string"==typeof n){if(!(t=document.getElementById(n)))throw new Error("Container parameter is not valid ID.")}else t=n;if("select-one"!=t.type&&"select-multiple"!=t.type)throw new Error("Container must be Select");var l,o=t.options,i=[],c=r(o);try{var s=function(){var e=l.value;if(!e.value)return"continue";var t="base",r=e.getAttribute("data-tab");r&&(t=r);var n=e.text;if(a.length>1){var o=a.find((function(e){return e.id==t}));o&&(n=o.title+": "+n)}i.push({id:e.value,title:n,entityId:"main",tabs:t,selected:e.selected})};for(c.s();!(l=c.n()).done;)s()}catch(e){c.e(e)}finally{c.f()}var u={node:t,multiple:"select-multiple"==t.type,placeholder:t.dataset.placeholder?t.dataset.placeholder:null,items:i,tabs:a};this.renderTagSelector(u)}},{key:"renderTagSelector",value:function(e){e.node.style.display="none",new t.TagSelector({multiple:e.multiple,addButtonCaption:e.placeholder,dialogOptions:{multiple:e.multiple,items:e.items,selectedItems:e.items.filter((function(e){return e.selected})),dropdownMode:!0,enableSearch:!1,compactView:!1,tabs:e.tabs},events:{onBeforeTagAdd:function(t){var r=t.getData().tag;if(e.multiple){var n=e.node.querySelectorAll('option[value="'+r.getId()+'"]');n.length>0&&(n[0].selected=!0)}else e.node.value=r.getId();e.node.dispatchEvent(new Event("change"))},onBeforeTagRemove:function(t){if(e.multiple){var r=t.getData().tag,n=e.node.querySelectorAll('option[value="'+r.getId()+'"]');n.length>0&&(n[0].selected=!1)}else e.node.value=null;e.node.dispatchEvent(new Event("change"))}}}).renderTo(e.node.parentNode)}}]),e}();e.UiSelect=a}(this.BX.Protocol=this.BX.Protocol||{},BX.UI.EntitySelector);
